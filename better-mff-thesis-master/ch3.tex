\chapter{Výsledky a diskuze}\label{chap:ch3}
V první části této kapitoly ukážeme výsledky řady modelů, jejichž výpočet byl po teoretické stránce popsán v kapitole \ref{chap:statistika}. V druhé části diskutujeme výsledky.

\section{Analýza lineární smíšených modelů}
Nyní studujeme pomocí lineárního smíšeného modelu vztah mezi rozdílem maximálních, resp. minimálních teplot poblíž země a ve výšce $\SI{2}{m}$ nad zemí a meteorologických podmínek: výšce sněhu, půdní vlhkosti, oblačnosti, insolaci, rychlosti větru a množství srážek.

Uvedeme zde celkově 32 modelů, které rozdělíme do tabulek podle výšky pozemního čidla, minimálních/maximálních teplot a toho, jestli bereme absolutní hodnotu závislé proměnné (tyto modely označujeme jako modely "s absolutní hodnotou"). Teplou sezónou (téměř bez sněhu) pak nazýváme období od začátku května do konce října a studená sezóna bude od začátku listopadu do konce dubna. Podle tabulky \ref{tab:seznammodelu} počítáme také modely, které se týkají pouze teplot v $\SI{15}{cm}$, protože změníme prediktor výšky sněhu na kategorickou proměnnou. Hodnota $0$ bude odpovídat hodnotám bez sněhu, $1$ hodnotám se sněhem menším než $\SI{15}{cm}$ a $2$ hodnotám nad $\SI{15}{cm}$.

Pro každý model uvedeme podmíněné a marginální $R^2$, koeficienty jednotlivých prediktorů v modelu, jejich chybu (uvádíme jí v závorce, tedy $\SI{1.61(1)}{}$ je to samé jako $\SI[separate-uncertainty = true]{1.61\pm 0.01}{}$) a označíme ty, které vyšly jako statisticky nevýznamné.

V tabulce \ref{tab:max15cm_models} jsou modely pro maximální teplotu a pozemní čidlo v $\SI{15}{cm}$ a v tabulce \ref{tab:max15cm_models_abs} ty samé, ale s absolutní hodnotou. V tabulce \ref{tab:max0cm_models} pro maximální teplotu a $\SI{0}{cm}$ a k nim s absolutní hodnotou v tabulce \ref{tab:max0cm_models_abs}. V tabulce \ref{tab:min15cm_models} jsou modely pro minimální teplotu a $\SI{15}{cm}$ a v tabulce \ref{tab:min15cm_models_abs} opět s absolutní hodnotou. Nakonec v tabulce \ref{tab:min0cm_models} jsou modely pro minimální teplotu a $\SI{0}{cm}$ a v tabulce \ref{tab:min0cm_models_abs} jsou modely s absolutní hodnotou. Zkratky všech modelů jsou rozepsané v tabulce \ref{tab:seznammodelu}. Postupem popsaným v kapitole \ref{chap:methods} jsme ověřili předpoklady všech modelů a určili, že zde není významná autokorelace, jestliže použijeme autokorelační strukturu ARMA ($p=2$ a $q=1$). Také jsme se na základě výběru a analýzy semivariogramů rozhodli prostorovou korelaci zanedbat a ověřili jsme, že v datech není přítomná heteroskedasticita a že residuály modelu nejsou významně odlišné od normálního rozdělení než na obrázku \ref{fig:qq_curt}.

16 modelů s absolutní hodnotou jsme počítali, aby byla interpretace výsledků jednodušší. Jestliže se snažíme interpretovat velikost koeficientu prediktoru v modelu, tak pokud nepoužijeme absolutní hodnotu, nedokážeme vždy určit, jestli dochází ke snížení rozdílu teplot mezi čidly. Pokud je koeficient kladný, znamená to, že rozdíl teplot roste. To může znamenat, že se záporné hodnoty zvětšují k nule (neboli gradient u země se zmenšuje) nebo že kladné hodnoty rostou (neboli teplotní gradient se zvětšuje). Pokud spočteme model s absolutní hodnotou, můžeme rozhodnout jestli má prediktor složitější vliv na rozdíl teplot nebo primárně snižuje jejich rozdíl. Model AMax0cold se nám nepodařilo spočítat, kvůli problémům s konvergencí funkce \texttt{lme}.

\clearpage

\begin{table}
\centering\footnotesize\sf
\begin{tabular}{lrrrrr}
\toprule
	Model & Max15all & Max15warm & Max15cold & Max15allc & Max15coldc \\
\midrule
	$R_m^2$ & $0.031$ & $0.098$ & $0.066$ & $0.032$ & $0.067$\\
	$R_c^2$ & $0.20$ & $0.51$ & $0.19$ & $0.20$ & $0.19$\\
\midrule
	Konstanta & $\SI{0.42(6)}{}$ & $\SI{-0.55(7)}{}$ & $\SI{0.96(7)}{}$ & $\SI{0.43(6)}{}$ & $\SI{0.99(7)}{}$\\
	Výška sněhu & $\SI{0.0045(7)}{}$ & - & $\SI{0.0031(7)}{}$ & $\SI{0.040(9)}{}$ & \textcolor{gray}{$\SI{0.005(9)}{}$}\\
	Oblačnost & $\SI{-0.041(8)}{}$ & $\SI{-0.16(1)}{}$ & $\SI{0.03(1)}{}$ & $\SI{-0.040(8)}{}$ & $\SI{0.03(1)}{}$\\
	Vlhkost & $\SI{-0.6(1)}{}$ & $\SI{2.2(1)}{}$ & $\SI{-2.4(2)}{}$ & $\SI{-0.6(1)}{}$ & $\SI{-2.4(2)}{}$\\
	Srážky & \textcolor{gray}{$\SI{0.002(2)}{}$} & $\SI{-0.04(1)}{}$ & \textcolor{gray}{$\SI{0.003(2)}{}$} & \textcolor{gray}{$\SI{0.002(2)}{}$} & \textcolor{gray}{$\SI{0.003(2)}{}$}\\
	Rychlost větru & $\SI{-0.0072(4)}{}$ & $\SI{-0.0034(7)}{}$ & $\SI{-0.0098(6)}{}$ & $\SI{-0.0072(4)}{}$ &$\SI{-0.0098(6)}{}$\\
	Insolace & $\SI{0.00042(1)}{}$ & $\SI{0.00065(1)}{}$ & $\SI{0.00029(2)}{}$ & $\SI{0.00042(1)}{}$ & $\SI{0.00028(2)}{}$\\
\bottomrule
\end{tabular}
	\caption{Srovnání modelů pro maximální denní teplotu a výšku $\SI{15}{cm}$. Šedě označené jsou hodnoty, pro které vyšla v F testu p hodnota $>0.05$ a nepovažujeme je statisticky významné od nuly (nezavrhli jsme nulovou hypotézu). Standardní chyba koeficientu je uvedená v závorce.}
	\label{tab:max15cm_models}
\end{table}

\begin{table}
\centering\footnotesize\sf
	\resizebox{\textwidth}{!}{\begin{tabular}{lrrrrr}
\toprule
	Model & AMax15all & AMax15warm & AMax15cold & AMax15allc & AMax15coldc \\
\midrule
	$R_m^2$ & $0.089$ & $0.11$ & $0.066$ & $0.086$ & $0.079$\\
	$R_c^2$ & $0.37$ & $0.54$ & $0.19$ & $0.37$ & $0.23$\\
\midrule
	Konstanta & $\SI{1.02(3)}{}$ & $\SI{1.08(3)}{}$ & $\SI{0.92(3)}{}$ & $\SI{1.04(3)}{}$ & $\SI{0.97(3)}{}$\\
	Výška sněhu & $\SI{0.0044(3)}{}$ & - & $\SI{0.0044(3)}{}$ & \textcolor{gray}{$\SI{0.024(3)}{}$} & \textcolor{gray}{$\SI{0.022(4)}{}$}\\
	Oblačnost & $\SI{-0.304(4)}{}$ & $\SI{-0.357(6)}{}$ & $\SI{-0.263(5)}{}$ & $\SI{-0.301(4)}{}$ & $\SI{-0.260(5)}{}$\\
	Vlhkost & \textcolor{gray}{$\SI{0.18(5)}{}$} & \textcolor{gray}{$\SI{-0.08(6)}{}$} & \textcolor{gray}{$\SI{0.32(6)}{}$} & $\SI{0.14(5)}{}$ & \textcolor{gray}{$\SI{0.26(6)}{}$}\\
	Srážky & $\SI{-0.0023(9)}{}$ & $\SI{-0.04(1)}{}$ & \textcolor{gray}{$\SI{-0.001(1)}{}$} & $\SI{-0.0023(9)}{}$ & \textcolor{gray}{$\SI{-0.001(1)}{}$}\\
	Rych. větru & $\SI{-0.0025(2)}{}$ & $\SI{-0.0035(3)}{}$ & $\SI{-0.0026(2)}{}$ & $\SI{-0.0024(2)}{}$ & $\SI{-0.0026(2)}{}$\\
	Insolace & $\SI{0.000193(5)}{}$ & $\SI{0.000306(7)}{}$ & $\SI{0.000166(7)}{}$ & $\SI{0.000190(5)}{}$ & $\SI{0.000161(7)}{}$\\
\bottomrule
	\end{tabular}}
	\caption{Srovnání modelů pro maximální denní teplotu a výšku $\SI{15}{cm}$ se závislou proměnnou v absolutní hodnotě. Šedě označené jsou hodnoty, pro které vyšla v F testu p hodnota $>0.05$ a nepovažujeme je statisticky významné od nuly (nezavrhli jsme nulovou hypotézu). Standardní chyba koeficientu je uvedená v závorce.}
	\label{tab:max15cm_models_abs}
\end{table}

\begin{table}
\centering\footnotesize\sf
\begin{tabular}{lrrr}
\toprule
	Model & Max0all & Max0warm & Max0cold \\
\midrule
	$R_m^2$ & $0.055$ & $0.20$ & $0.087$ \\
	$R_c^2$ & $0.16$ & $0.60$ & $0.16$ \\
\midrule
	Konstanta & $\SI{-0.28(7)}{}$ & \textcolor{gray}{$\SI{-2.5(1)}{}$} & $\SI{0.99(7)}{}$ \\
	Výška sněhu & $\SI{0.0197(9)}{}$ & - & $\SI{0.0158(8)}{}$ \\
	Oblačnost & $\SI{0.09(1)}{}$ & $\SI{0.11(2)}{}$ & $\SI{0.09(1)}{}$ \\
	Vlhkost & $\SI{0.8(1)}{}$ & $\SI{6.7(2)}{}$ & $\SI{-2.6(2)}{}$ \\
	Srážky & \textcolor{gray}{$\SI{0.02(1)}{}$} & $\SI{0.05(1)}{}$ & $\SI{-0.04(2)}{}$ \\
	Rychlost větru & $\SI{-0.0138(5)}{}$ & $\SI{-0.0020(9)}{}$ & $\SI{-0.0161(7)}{}$ \\
	Insolace & $\SI{-0.00026(1)}{}$ & $\SI{-0.00027(2)}{}$ & $\SI{-0.00030(2)}{}$ \\
\bottomrule
\end{tabular}
	\caption{Srovnání modelů pro maximální denní teplotu a výšku $\SI{0}{cm}$. Šedě označené jsou hodnoty, pro které vyšla v F testu p hodnota $>0.05$ a nepovažujeme je statisticky významné od nuly (nezavrhli jsme nulovou hypotézu). Standardní chyba koeficientu je uvedená v závorce.}
	\label{tab:max0cm_models}
\end{table}

\begin{table}
\centering\footnotesize\sf
\begin{tabular}{lrrr}
\toprule
	Model & AMax0all & AMax0warm & AMax0cold \\
\midrule
	$R_m^2$ & $0.069$ & $0.10$ & - \\
	$R_c^2$ & $0.19$ & $0.33$ & - \\
\midrule
	Konstanta & $\SI{1.10(2)}{}$ & $\SI{1.32(3)}{}$ & - \\
	Výška sněhu & $\SI{0.0052(3)}{}$ & - & - \\
	Oblačnost & $\SI{-0.247(7)}{}$ & $\SI{-0.300(6)}{}$ & - \\
	Vlhkost & $\SI{0.31(5)}{}$ & $\SI{-0.46(6)}{}$ & - \\
	Srážky & $\SI{-0.020(5)}{}$ & $\SI{-0.029(6)}{}$ & - \\
	Rychlost větru & $\SI{-0.0012(2)}{}$ & $\SI{-0.0011(4)}{}$ & - \\
	Insolace & $\SI{0.000129(5)}{}$ & $\SI{0.000236(7)}{}$ & - \\
\bottomrule
\end{tabular}
	\caption{Srovnání modelů pro maximální denní teplotu a výšku $\SI{0}{cm}$ se závislou proměnnou v absolutní hodnotě. Šedě označené jsou hodnoty, pro které vyšla v F testu p hodnota $>0.05$ a nepovažujeme je statisticky významné od nuly (nezavrhli jsme nulovou hypotézu). Standardní chyba koeficientu je uvedená v závorce. Model AMax0cold se nám nepodařilo spočítat.}
	\label{tab:max0cm_models_abs}
\end{table}

\begin{table}
\centering\footnotesize\sf
\begin{tabular}{lrrrrr}
\toprule
	Model & Min15all & Min15warm & Min15cold & Min15allc & Min15coldc\\
\midrule
	$R_m^2$ & $0.14$ & $0.24$ & $0.12$ & $0.090$ & $0.055$\\
	$R_c^2$ & $0.42$ & $0.71$ & $0.29$ & $0.37$ & $0.22$\\
\midrule
	Konstanta & $\SI{-1.23(5)}{}$ & $\SI{-2.44(7)}{}$ & $\SI{-0.11(6)}{}$ & $\SI{-1.17(5)}{}$ & $\SI{-0.1(6)}{}$\\
	Výška sněhu & $\SI{0.0222(5)}{}$ & - & $\SI{0.0214(6)}{}$ & $\SI{0.226(7)}{}$ & $\SI{0.211(8)}{}$\\
	Oblačnost & $\SI{0.211(6)}{}$ & $\SI{0.265(7)}{}$ & $\SI{0.185(9)}{}$ & $\SI{0.217(6)}{}$ & $\SI{0.194(9)}{}$\\
	Vlhkost & $\SI{1.9(1)}{}$ & $\SI{4.5(1)}{}$ & $\SI{-0.6(1)}{}$ & $\SI{1.8(1)}{}$ & $\SI{-0.7(1)}{}$\\
	Srážky & \textcolor{gray}{$\SI{0.0006(6)}{}$} & \textcolor{gray}{$\SI{0.0005(6)}{}$} & \textcolor{gray}{$\SI{-0.001(1)}{}$} & \textcolor{gray}{$\SI{0.0005(6)}{}$} & \textcolor{gray}{$\SI{-0.002(1)}{}$}\\
	Rychlost větru & $\SI{-0.0018(4)}{}$ & $\SI{0.0106(5)}{}$ & $\SI{-0.0073(5)}{}$ & $\SI{-0.0016(4)}{}$ &$\SI{-0.0071(5)}{}$\\
	Insolace & $\SI{0.00006(2)}{}$ & $\SI{0.00028(2)}{}$ & $\SI{-0.00027(4)}{}$ & $\SI{0.00006(2)}{}$ & $\SI{-0.00026(4)}{}$\\
\bottomrule
\end{tabular}
	\caption{Srovnání modelů pro minimální denní teplotu a výšku $\SI{15}{cm}$. Šedě označené jsou hodnoty, pro které vyšla v F testu p hodnota $>0.05$ a nepovažujeme je statisticky významné od nuly (nezavrhli jsme nulovou hypotézu). Standardní chyba koeficientu je uvedená v závorce.}
	\label{tab:min15cm_models}
\end{table}

\begin{table}
\centering\footnotesize\sf
\begin{tabular}{lrrrrr}
\toprule
	Model & AMin15all & AMin15warm & AMin15cold & AMin15allc & AMin15coldc\\
\midrule
	$R_m^2$ & $0.078$ & $0.13$ & $0.065$ & $0.065$ & $0.027$\\
	$R_c^2$ & $0.51$ & $0.65$ & $0.37$ & $0.50$ & $0.34$\\
\midrule
	Konstanta & $\SI{1.21(3)}{}$ & $\SI{1.45(3)}{}$ & $\SI{0.89(3)}{}$ & $\SI{1.25(3)}{}$ & $\SI{0.95(3)}{}$\\
	Výška sněhu & $\SI{0.0067(2)}{}$ & - & $\SI{0.0072(3)}{}$ & $\SI{0.047(3)}{}$ & $\SI{0.052(3)}{}$\\
	Oblačnost & $\SI{-0.131(3)}{}$ & $\SI{-0.162(4)}{}$ & $\SI{-0.101(4)}{}$ & $\SI{-0.128(3)}{}$ & $\SI{-0.097(4)}{}$\\
	Vlhkost & $\SI{-0.85(4)}{}$ & $\SI{-1.48(5)}{}$ & $\SI{-0.09(6)}{}$ & $\SI{-0.93(4)}{}$ & $\SI{-0.21(6)}{}$\\
	Srážky & $\SI{-0.0008(3)}{}$ & \textcolor{gray}{$\SI{-0.0005(3)}{}$} & $\SI{-0.0013(6)}{}$ & $\SI{-0.0008(3)}{}$ & $\SI{-0.0015(6)}{}$ \\
	Rychlost větru & $\SI{-0.0047(2)}{}$ & $\SI{-0.0042(3)}{}$ & $\SI{-0.0053(2)}{}$ & $\SI{-0.0045(2)}{}$ & $\SI{-0.0051(2)}{}$\\
	Insolace & $\SI{0.00007(1)}{}$ & $\SI{0.00003(1)}{}$ & $\SI{0.00009(2)}{}$ & $\SI{0.00007(1)}{}$ & $\SI{0.00009(2)}{}$\\
\bottomrule
\end{tabular}
	\caption{Srovnání modelů pro minimální denní teplotu a výšku $\SI{15}{cm}$ se závislou proměnnou v absolutní hodnotě. Šedě označené jsou hodnoty, pro které vyšla v F testu p hodnota $>0.05$ a nepovažujeme je statisticky významné od nuly (nezavrhli jsme nulovou hypotézu). Standardní chyba koeficientu je uvedená v závorce.}
	\label{tab:min15cm_models_abs}
\end{table}

\begin{table}
\centering\footnotesize\sf
\begin{tabular}{lrrr}
\toprule
	Model & Min0all & Min0warm & Min0cold \\
\midrule
	$R_m^2$ & $0.050$ & $0.21$ & $0.088$ \\
	$R_c^2$ & $0.28$ & $0.57$ & $0.23$ \\
\midrule
	Konstanta & $\SI{0.30(6)}{}$ & $\SI{-1.60(8)}{}$ & $\SI{1.63(6)}{}$ \\
	Výška sněhu & $\SI{0.0171(5)}{}$ & - & $\SI{0.0152(6)}{}$ \\
	Oblačnost & $\SI{0.053(8)}{}$ & $\SI{0.21(1)}{}$ & $\SI{-0.05(1)}{}$ \\
	Vlhkost & $\SI{0.9(1)}{}$ & $\SI{5.1(2)}{}$ & $\SI{-1.9(1)}{}$ \\
	Srážky & $\SI{0.0008(4)}{}$ & $\SI{0.0059(9)}{}$ & \textcolor{gray}{$\SI{-0.0002(4)}{}$} \\
	Rychlost větru & $\SI{-0.0184(5)}{}$ & $\SI{-0.0065(7)}{}$ & $\SI{-0.0241(6)}{}$ \\
	Insolace & $\SI{-0.00018(3)}{}$ & $\SI{0.00015(4)}{}$ & $\SI{-0.00033(5)}{}$ \\
\bottomrule
\end{tabular}
	\caption{Srovnání modelů pro minimální denní teplotu a výšku $\SI{0}{cm}$. Šedě označené jsou hodnoty, pro které vyšla v F testu p hodnota $>0.05$ a nepovažujeme je statisticky významné od nuly (nezavrhli jsme nulovou hypotézu). Standardní chyba koeficientu je uvedená v závorce.}
	\label{tab:min0cm_models}
\end{table}

\begin{table}
\centering\footnotesize\sf
\begin{tabular}{lrrr}
\toprule
	Model & AMin0all & AMin0warm & AMin0cold \\
\midrule
	$R_m^2$ & $0.10$ & $0.053$ & $0.13$ \\
	$R_c^2$ & $0.19$ & $0.29$ & $0.22$ \\
\midrule
	Konstanta & $\SI{1.08(2)}{}$ & $\SI{0.81(3)}{}$ & $\SI{1.24(3)}{}$ \\
	Výška sněhu & $\SI{0.0098(3)}{}$ & - & $\SI{0.0098(3)}{}$ \\
	Oblačnost & $\SI{-0.106(3)}{}$ & $\SI{-0.091(4)}{}$ & $\SI{-0.098(4)}{}$ \\
	Vlhkost & $\SI{0.33(5)}{}$ & $\SI{0.70(6)}{}$ & \textcolor{gray}{$\SI{0.10(6)}{}$} \\
	Srážky & \textcolor{gray}{$\SI{-0.0003(2)}{}$} & \textcolor{gray}{$\SI{0.0001(4)}{}$} & \textcolor{gray}{$\SI{-0.0004(2)}{}$} \\
	Rychlost větru & $\SI{-0.0086(2)}{}$ & $\SI{-0.0038(3)}{}$ & $\SI{-0.0111(3)}{}$ \\
	Insolace & $\SI{0.00015(1)}{}$ & $\SI{0.00008(2)}{}$ & $\SI{0.00017(2)}{}$ \\
\bottomrule
\end{tabular}
	\caption{Srovnání modelů pro minimální denní teplotu a výšku $\SI{0}{cm}$ se závislou proměnnou v absolutní hodnotě. Šedě označené jsou hodnoty, pro které vyšla v F testu p hodnota $>0.05$ a nepovažujeme je statisticky významné od nuly (nezavrhli jsme nulovou hypotézu). Standardní chyba koeficientu je uvedená v závorce.}
	\label{tab:min0cm_models_abs}
\end{table}

\clearpage

\subsection{Předpoklady lineárního smíšeného modelu}
Pro každý model jsme ověřili jednotlivé předpoklady, jak bylo popsáno v kapitole \ref{chap:analysis}. Pokud se zaměříme na normálnost residuálů modelu, tak všechny mají nezanedbatelnou míru šikmosti nebo jiných odlehlých hodnot, které se nám nepodařilo žádnou transformací opravit. Existují i složitější transformace, které jsme nezkoušeli jako například Box-Cox transformace nebo jiné, které by data mohla zlepšit. Složitější transformací může být ale těžší na interpretaci, protože například používáme nějaký posun hodnot o konstantu, a proto jsme v této práci zvolili transformaci pomocí třetí odmocniny. 

Dále jsem ověřovali autokorelaci časových řad. Pomocí modelu ARMA jsme vylepšili původní model, ale i nadále některé hodnoty autokorelace neklesly do takové míry, abychom mohli říct, že zde autokorelace není. Jedním z řešení by mohlo být například pracovat s delší časovou řadou a následně vyřadit každý x-tý den a tím autokorelaci snížit. 

Z několika variogramů jsme určili, že prostorová korelace není v našich datech silná. Zároveň jsme ale nezkoumali jiné typy korelace, například korelace dat s výškou nad zemí nebo v množstvím potenciální solární radiace nebo topografického vlhkostního indexu, což jsou všechno veličiny, podle kterých byla čidla rozdělovaná do jednotlivých tříd, viz kapitola \ref{chap:data_buav}. Složitější způsob modelování dat by bylo použít prostoročasový model.

Výše popsané problémy můžou zkreslovat naše výsledky. Interpretace výše ovšem nezáleží na konkrétních hodnotách vysvětlené variability nebo jednotlivých koeficientů, ale především na znamenkách prediktorů a obecnější trend, který je vůči těmto problémům robustnější.

\subsection{Insolace a minimální teplota}\label{chap:mintemp_insolation}
Insolaci je vybrána jako jeden z prediktorů, abychom v datech zahrnuli i denní a roční chod. Zvolený způsob má výhodu z hlediska výpočetního času, jde o jeden prediktor. Další výhoda je, že pak jde o fyzikální veličinu s jasnou interpretací. První problém je, že insolace se mění během dne a tudíž můžeme dostat dvě stejné hodnoty i např. měsíc od sebe, pouze z důvodu, že denní maximum (nebo minimum) nastalo v jinou denní dobu a tím se maskuje roční průběh. Druhý problém je, že jsme se rozhodli brát insolaci v noci rovnou nule, ale pro minimální teploty a pro období, kdy je čidlo pod sněhem, máme většinu hodnot nulových a pak nám prediktor neříká nic o denní nebo roční době. Řešením, které se zde nabízí, je rozdělit prediktor na dva pro denní a roční chod zvlášť s tím, že pro noční dobu neurčíme pouze jednu hodnotu. Těmito prediktory by mohlo být například maximální denní insolace a hodinový úhel Slunce.

\subsection{Srovnání modelů pro maximální teplotu a výšku $\SI{15}{cm}$}
V tabulce \ref{tab:max15cm_models} srovnáváme modely pro maximální denní teplotu a výšku $\SI{15}{cm}$ mezi sebou (modely s absolutní hodnotou jsou tabulce \ref{tab:max15cm_models_abs}). Když srovnáme kvalitu modelů jako množství vysvětlené variability, tak model pro teplou sezónu vychází nejlépe s $R_c^2 = 0.51$, resp. $R_c^2 = 0.54$ pro model s absolutní hodnotou. \textit{Výška sněhu} má kladný vliv na rozdíl teplot a vede k jeho nárůstu, což je v souladu s teorií v kapitole \ref{chap:vlivmeteo}. Čidlo nacházející se pod sněhem totiž může mít výrazně rozdílnou teplotu od čidla ve standardní výšce (vliv sněhu na teploty v lesním klimatu popisují se stejnými závěry také \cite{snow_deFrenneForestMicroclimates}). 3 ze 4 modelů pro výšku sněhu jako kategorickou proměnnou nejsou signifikantní, je možné, že nahrazením ztratíme moc velké množství informací a že tím klesne v modelu závislost na sněhové pokrývce.

Pokud srovnáme modely Max15warm a Max15cold, vidíme, že \textit{oblačnost} má opačný vliv na rozdíl teplot. Z modelů AMax15warm a AMax15cold je zřejmé, že oblačnost snižuje rozdíl teplot na čidlech. Gradient teplot blízko země roste s ohřevem povrchu slunečním zářením, tudíž oblačnost přes den tento gradient snižuje. Vliv oblačnosti na mikroklima jako faktor snižující absolutní gradient teplot je popsán např. zde \cite{snow_deFrenneForestMicroclimates, cloud_overwinteringclusters}. Koeficienty pro prediktor oblačnosti jsou pro modely s absolutní hodnotou několikanásobně vyšší, to naznačuje, že oblačnost především snižuje absolutní rozdíl teplot. Tuto roli plní také přítomnost lesního porostu \parencite{ZellwegerFlorian2019Sdou}. Jestliže je pozemní čidlo pod sněhem, může maximální teplota nastávat i v noci. V tuto dobu oblačnost omezuje únik tepla dlouhovlnným zářením, a tedy nedochází k tak rychlému poklesu teplot. Pokud je čidlo pod sněhem, tak meteorologické podmínky ovlivňují hlavně čidlo ve standardní výšce $\SI{2}{m}$, protože pozemní čidlo má většinou teplotu blízkou $\SI{0}{\celsius}$.

Vliv \textit{půdní vlhkosti} na rozdíl teplot je v teplém období kladný a ve studeném záporný. Pro celou časovou řadu pak vychází lehce záporný. Pro 4 z 5 modelů s absolutní hodnotou je vliv vlhkosti statisticky významný, to znamená, že dopad tohoto prediktoru je složitější než jenom nárůst nebo pokles absolutního gradientu teplot. Pokud je na zemi přítomný sníh, půdní vlhkost může rychle vzrůst, když stoupne teplota a sníh začne tát. Pokud je čidlo stále pod sněhem tak bude teplota blízká $\SI{0}{\celsius}$, zatímco ve výšce $\SI{2}{m}$ můža teplota růst více oproti stavu, kdy sníh netál. Teploty ve $\SI{2}{m}$ tedy byly záporné a zvýšily se, čímž mohlo dojít k poklesu rozdílu teplot, jak vidíme v tabulce pro studené období. V teplém období narůstá půdní vlhkost zejména po dešti. Vzhledem k experimentálnímu uspořádání čidel (viz kapitola \ref{chap:loggers}) je čidlo ve $\SI{2}{m}$ lépe odstíněno od deště a tudíž jakmile po dešti začne teplota stoupat, bude se v této výšce tak dít rychleji než na čidle poblíž země. Rozdíl teplot tedy bude růst, jak opět vidíme v tabulce. V teplém období také při poklesu půdní vlhkosti klesá míra evapotranspirace a tím narůstá teplota v bylinném patře (o vztahu teplot v lesním porostu s transpirace pojednávají \cite{snow_deFrenneForestMicroclimates}).

\textit{Srážky} vedou k poklesu absolutního rozdílu teplot. Výjimkou je ale studené období, což je způsobeno několika různými faktory. Část období je pozemní čidlo pod sněhem, tudíž nové srážky na něj nemusí mít vliv a dále čidlo, které je ve $\SI{2}{m}$, tak je upevněno na stromě a tudíž stíněno od slabých srážek. Pro lepší kvantifikaci vlivu srážek bychom potřebovali podrobnější data z lesního porostu.

\textit{Rychlost větru} má napříč všemi modely záporný vliv na rozdíl teplot, což je ve shodě s teorií popsanou v \ref{chap:vlivmeteo}. To, že je ve studeném období vliv silnější, bude nejspíš způsobeno opět tím, že čidlo poblíž země je část zimy pod sněhem. Vítr pak ovlivňuje výhradně čidlo ve standardní výšce (podobný vliv větru je popsán i ve článku \cite{wind_contrastingmicroclimates}). \textit{Insolace} je nejslabší ze všech prediktorů a má pro tuto sadu modelů vždy kladný vliv. Vyšší insolace znamená potenciálně větší množství záření dopadající na povrch a ohřívající pozemní čidlo.

\subsection{Srovnání modelů pro maximální teplotu a výšku $\SI{0}{cm}$}
V tabulce \ref{tab:max0cm_models} obdobně předchozí kapitole máme srovnání modelů maximální denní teploty a výšky $\SI{0}{cm}$. \textit{Výška sněhu} má opět kladný vliv na rozdíl teplot. Vliv je také několikanásobně vyšší, srovnejme hodnotu $\SI{0.0031(7)}{}$ pro studené období a výšku $\SI{15}{cm}$ s hodnotou koeficientu $\SI{0.0158(8)}{}$ pro model $\SI{0}{cm}$ a studené období. To ovšem je v souladu s tím, že níže položené čidlo bude pod sněhem delší dobu (tento vliv sněhové pokrývky na teploty poblíž země byl popsán i v \cite{snow_deFrenneForestMicroclimates}).

Pro \textit{oblačnost} jsou na rozdíl od hodnot v tabulce \ref{tab:max15cm_models} všechny hodnoty kladné. Když se podíváme na modely s absolutní hodnotou, tak vidíme, že oblačnost snižuje absolutní rozdíl teplot. Vzhledem k tomu, že koeficienty pro modely bez absolutní hodnoty také vycházejí signifikantně, je pravděpodobné, že existují další složitější vazby mezi rozdílem teplot a oblačností a dalšími prediktory.

\textit{Vlhkost půdy} je pro teplé období nejsilnějším prediktorem. Zřejmě je to způsobeno malou vzdáleností od měření vlhkosti půdy k povrchu, která více ovlivňuje čidlo ve výšce $\SI{0}{cm}$ než v $\SI{15}{cm}$, ovšem pro studené období už není rozdíl tak významný. Při poklesu půdní vlhkosti klesá schopnost rostlin transpirovat, tento vliv je nejvýznamnější v létě (o vztahu transpirace a následného nárůstu teplot pojednávali \cite{snow_deFrenneForestMicroclimates}). Vliv na rozdíl teplot je v jednotlivých obdobích stejný jako pro $\SI{15}{cm}$, ale silnější vliv v teplém období způsobí, že výsledný dopad na rozdíl teplot pro všechna dostupná data je kladný.

\textit{Srážky} jsou pro sezónní modely signifikantním prediktorem a obecně opět vedou k poklesu absolutního gradientu teplot skrze ochlazení povrchu. Srážky z fyzikálního hlediska také souvisí s přítomností oblačnosti, ovšem v našich datech je korelace velmi nízká (a záporná) $-0.043$. To může být způsobeno využitím dat z ERA5 nebo příliš malou četností srážek.

\textit{Rychlost větru} má záporný vliv a opět platí, že ve studeném období je silnější než v teplém. Když srovnáme velikost koeficientů ve studeném období mezi modely pro $\SI{0}{cm}$ a $\SI{15}{cm}$, tak pro první z nich je v absolutní hodnotě vyšší. Čidlo blíže země je pravděpodobně více stíněno od větru a tudíž jsou zde více rozdílné podmínky od čidla ve $\SI{2}{m}$ (vliv větru na mikroklima byl pozorován např. ve článku \cite{wind_contrastingmicroclimates}). 

\textit{Insolace} má kladný vliv pro modely s absolutní hodnotou, opět je to způsobené ohřevem povrchu. Pro modely bez absolutní hodnoty jsou koeficienty záporné. Očekávali bychom, že vyšší hodnota insolace povede k rychlejšímu ohřevu pozemního čidla a tedy, že rozdíl teplot bude růst. Insolace zároveň není závislá na ostatních veličinách. Čas v kterém nastane maximální teplota už ano. Koeficienty pro modely bez absolutní hodnoty jsou řádově menší, tudíž by to mohlo být způsobeno například korelací s rychlostí větru, která má také záporný vliv. Korelace ovšem není moc vysoká, pouze $0.098$.

\subsection{Srovnání modelů pro minimální teplotu a výšku $\SI{15}{cm}$}
Pro interpretaci výsledků v tabulce \ref{tab:min15cm_models} a \ref{tab:min15cm_models_abs} je nutné si uvědomit, že minimální teplota většinou nastává v ranních hodinách. V období, kdy se na zemi nachází sníh, minimální teplota nastává během nocí (viz obrázek \ref{fig:hours}). Z tohoto důvodu jsou hodnoty \textit{insolace} pro většinu minimálních teplot nulové a tedy nám tento prediktor nemůže poskytnout mnoho informací, více k tomuto v kapitole \ref{chap:mintemp_insolation}. I přesto jsou pro všechny modely s absolutní hodnotou koeficienty prediktoru insolace kladné. To bychom očekávali kvůli souvislosti s ohřevem povrchu, nabývají ovšem menších hodnot.

Stejně jako u všech ostatních modelů popsaných výše, můžeme vidět, že \textit{výška sněhu} má kladný vliv na rozdíl teplot. To je způsobené tím, že dochází k odlišnému chování teplot u země a ve výšce $\SI{2}{m}$ (jak bylo popsáno v \cite{snow_deFrenneForestMicroclimates}). Také si můžeme všimnout, že podobně jako u modelu Max15allc, tak u modelů Min15allc a Min15coldc je sníh silnějším prediktorem. V tomto případě až desetinásobně, ale neplatí to pro modely s absolutní hodnotou.

\textit{Oblačnost} je pro rozdíl teplot (kladným) významným prediktorem a má silnější vliv než u maximálních teplot. V noci přítomnost oblačnosti snižuje míru ochlazování povrchu, klesá absolutní gradient teplot. Můžeme vidět na modelech s absolutní hodnotou, že prediktor je vždy záporný. Pokles absolutního gradientu teplot je popsán i ve studii \cite{cloud_overwinteringclusters}. 

\textit{Půdní vlhkost} snižuje absolutní rozdíl teplot. Nemůžeme opomenout vliv transpirace rostlin, která se v menší míře děje i v noci (podle práce \cite{nighttranspiration}), ale zároveň nemusí mít vliv, pokud nerostou na zemi menší byliny. Pro studené období má půdní vlhkost o něco slabší záporný vliv. Opět zde bude často nárůst vlhkosti spojen s táním sněhu a oteplením. Z modelu AMin15cold můžeme vidět, že pokles absolutního rozdílu teplot zde není tak jednoznačný, a tedy vztah mezi vlhkostí a teplotami bude složitější.

\textit{Rychlost větru} i pro minimální teplotu vede k poklesu absolutního rozdílu teplot, který je zároveň stabilní i napříč studeným a teplým obdobím.

\subsection{Srovnání modelů pro minimální teplotu a výšku $\SI{0}{cm}$}
Koeficienty modelů pro minimální teplotu a výšku $\SI{0}{cm}$ jsou v tabulkách \ref{tab:min0cm_models} a \ref{tab:min0cm_models_abs}. \textit{Výška sněhu} má opět kladný vliv na rozdíl teplot, sníh tedy obecně způsobuje, že teploty pod sněhem jsou vyšší než ve výšce $\SI{2}{m}$. Všimněme si také, že blíže země je vliv sněhu silnější, například to můžeme vidět při srovnání modelů AMin0All a AMin15All.

\textit{Oblačnost} snižuje absolutní rozdíl teplot ovšem v menší míře než pro $\SI{15}{cm}$. \textit{Půdní vlhkost} má kladný vliv na absolutní rozdíl teplot, narozdíl od modelů pro $\SI{15}{cm}$. Zatímco ve výšce $\SI{15}{cm}$ je vliv deště hlavně vlivem ochlazení okolního vzduchu (které se děje i pro čidlo ve výšce $\SI{2}{m}$), tak pro samotný povrch půdy se může čidlo ocitnout pod vodou. Teploty zde tedy můžou klesnout více a tím absolutní rozdíl teplot naopak růst.

Vliv \textit{srážek} je pro část modelů nesignifikantní nebo s vysokou relativní chybou. Podle modelu Min0warm srážky v teplém období způsobují nárůst rozdílu teplot, nikoliv ovšem absolutního, tedy vliv na teplotu u povrchu země je složitější. \textit{Rychlost větru} má opět záporný vliv na absolutní rozdíl teplot, zároveň bychom očekávali, že bude menší než pro modely s $\SI{15}{cm}$. Pro teplé období je koeficient u modelu AMin0warm téměř stejný jako u AMin15warm. Důvod, proč je dvakrát vyšší v zimním období u modelu AMin0cold než u AMin15cold, zřejmě tkví v přítomnosti sněhu. Čidlo ve výšce $\SI{0}{cm}$ je sice lépe chráněno od větru, ale ve studeném období je déle pod sněhem. 

\textit{Insolace} má opět slabý kladný vliv, viz diskuze výše pro výšku $\SI{15}{cm}$.

\subsection{Syntéza všech modelů}
Napříč všemi modely můžeme pozorovat, že \textit{výška sněhu} zvětšuje rozdíl teplot mezi čidly poblíž země a ve výšce $\SI{2}{m}$. Zkoušeli jsme pro čidla ve výšce $\SI{15}{cm}$ nad zemí nahradit sníh kategorickou proměnnou, podle toho, jestli je čidlo pod sněhem nebo ne. Pro modely Max15allc, Min15allc a Min15coldc jsme tímto dosáhli toho, že prediktor se stal až desetkrát silnějším. Pro model Max15coldc vyšel koeficient nesignifikantní, možné důvody jsme diskutovali výše. Je zřejmé, že výška sněhu v lese může být velmi rozdílná od výšky sněhu na meteorologické stanici. Způsobuje to rozdílná nadmořská výška, vzdálenost míst od sebe nebo přítomnost porostu, který brání sněhu dopadnout na zem. Také brání tání sněhu, když přijde obleva. Ukázali jsme tedy, že sníh má silný význam na rozdíl teplot u země a to především tím, že pod dostatečnou vrstvou se teploty pohybují okolo $\SI{0}{\celsius}$. Dále by bylo možné spočítat modely se sněhem jako kategorickou proměnnou i pro výšku $\SI{0}{cm}$. Ovšem zde by ztráta informace o výšce sněhu byla ještě výraznější, protože by kategorická proměnná měla pouze dvě hodnoty. Vhodné by bylo k tomu použít data o výšce sněhu v lese. Z denního průběhu teplot na pozemním čidle by také bylo možné zkusit odvodit, kdy je čidlo pod sněhovou pokrývkou a nejlépe výsledky srovnat s přímým měřením sněhu v lese. Toto by ovšem vyžadovalo rozsáhlou analýzu časových řad, která je za rámcem možností této práce.

\textit{Oblačnost} je dalším silným prediktorem v našich modelech a bez výjimky způsobuje absolutní pokles rozdílu teplot, viz diskuze výše. Pro některé modely bez absolutní hodnoty dostáváme ovšem velmi různé hodnoty i magnitudy koeficientů, např. model Max15warm a Max15cold. Je pravděpodobné, že přítomnost sněhu koeficienty velmi ovlivní, ale jde o rozdíl, který by bylo vhodné dále prozkoumat. Například bychom se mohli podívat na počasí v době měření nebo souvislost s jinými prediktory než výškou sněhu. Prediktor oblačnosti bychom také mohli rozdělit podle typu oblačnosti: vysoká, střední a nízká oblačnost. Vysoká oblačnost, například typu cirrus, nesnižuje množství dopadajícího záření tolik jako typu altostratus, ale zároveň tyto oblaky souvisejí i s dalšími meteorologickými podmínkami jako příchod fronty a podobně.

\textit{Půdní vlhkost} je jediným prediktorem, který spolu s teplotami měříme na každém čidle. Toto má velkou výhodu a vysvětluje to, proč jde obecně o nejsilnější prediktor. Zde je také vztah zřejmě nejsložitější, jak si můžeme všimnout, když srovnáme například modely typu AMax15. Pouze pro jeden z nich vychází vlhkost signifikantní. Nemůžeme tedy jednoduše říct, že by vlhkost snižovala nebo zvyšovala rozdíl teplot, viz diskuze výše.

\textit{Srážky} naopak pro klasické modely vycházejí téměř vždy nesignifikantně a pro modely s absolutní hodnotou jsou vždy záporným prediktorem (nebo jsou nesignifikantní). Srážky zřejmě nemají tak silný nebo někdy dokonce skoro žádný vliv na rozdíl teplot. Částečně je to také způsobeno tím, že listy a větve stromů absorbují část srážek a také, že srážky někdy můžou být značně lokální v případě například přeháňky.

\textit{Rychlost větru} pro všechny modely způsobuje snižování absolutního rozdílu teplot, pro modely bez absolutní hodnoty je jedinou výjimkou model Min15warm, viz diskuze výše. Ačkoliv jde o jednoznačný prediktor, tak není příliš silný. To může být způsobeno velkou prostorovou variabilitou rychlost větru a přítomností lesa, který ji velmi ovlivňuje. Opět bychom očekávali, že prediktor bude silnější, pokud bychom měli lokálnější zdroj dat.

\textit{Insolace} má vždy kladný vliv na absolutní rozdíl teplot a je nejslabším prediktorem. Důvodem zřejmě bude, že v hodnotách insolace není započítaná oblačnost, přítomnost lesa, sklon a orientace svahu, na kterém se čidlo nachází. Sklon a orientaci svahu bychom mohli jednoduše přidat k prediktoru jako koeficient. Přítomnost lesa bychom mohli započítat pomocí analýzy hemifotografie, tedy fotografie z místa čidla, z které bychom zjistili kolik procent oblohy je viditelné. Další řešení by bylo mít na čidle fotodiodu a tímto detekovat, jestli na něj zrovna dopadá sluneční světlo. Zároveň bychom ovšem ztratili v datech roční a denní chod, viz diskuze v kapitole \ref{chap:mintemp_insolation}.

Pokud srovnáme modely z hlediska vysvětlené variability, vidíme, že se od sebe výrazně liší. Nejvyšší hodnoty mají tendenci mít modely pouze pro teplé období, z toho můžeme usuzovat, že přítomnost sněhu velmi komplikuje analýzu a vznikají zde jevy, které se snažíme modelovat lineárním modelem, ale lineární nejsou, například, to jestli je čidlo pod sněhem nebo nad sněhem. Kdybychom měli lokálnější data o výšce sněhové pokrývky, mohli bychom data nerozdělovat podle teplého a studeného období, ale podle přítomnosti sněhu. 

U všech modelů také zbývá velké množství vůbec nevysvětlené variability. V první řadě námi vybrané prediktory zdaleka nevyčerpávají informace o aktuálních meteorologických podmínkách. Více jsme jich nevybrali z důvodu výpočetní náročnosti modelů a také, že s více prediktory se objevují problémy s velkou vzájemnou korelací a takzvanému "overfittingu", kdy máme více prediktorů než můžeme zdůvodnit daty. Pro takové případy je vhodné použít například krokovou regresi a Akaikeho informační kritérium, kroková regrese by nám zvýšila výpočetní náročnost ještě více. Významná část nevysvětlené variability je daná tím, že čidla kterými jsme se zabývali, nejsou na stejných místech. U každého čidla se liší topografie a vegetace a další faktory zmiňované v kapitole \ref{chap:topo} a \ref{chap:veg}. Například pokud se budeme zabývat výškou sněhu tak náš způsob statistického zpracování dat nebere v potaz už zmiňované zachycení části sněhových srážek vegetací, ale také to, že na každém čidle bude míra zachycení sněhových srážek odlišná, dále také to, že čidla se nacházejí v různé nadmořské výšce a tudíž může být na zemi více či méně sněhu. Čidla se také nacházejí na topograficky různých místech. Některá můžou mít sněhovou pokrývku mnohem déle, protože se u nich drží studený vzduch a některá jsou naopak na jižních svazích a sníh zde roztaje rychleji. Hodnoty o výšce sněhu z několika meteorologických stanic nemůžou tyto nuance pokrýt a jde tedy o velkou mezeru ve zpracování dat. Uveďme ještě jeden příklad. Rychlost větru je také ovlivněna okolím čidla. Zde jsme opět předpokládali, že pro všechna čidla jsou podmínky stejné, ale velikost a hustota stromů v okolí se liší pro každý pár čidel stejně jako výška a typ vegetace. To jsou všechno spolu s lokální topografií faktory, které jsme ve statistickém zpracování nebrali v potaz a ovlivňují rychlost větru. Zahrnutí těchto a dalších vlivů by bylo možné, ale výrazně by zkomplikovalo analýzu, která by pak byla nad rámec této práce.
